{% extends "base.html" %}
{% block title %}Books{% endblock %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h1 class="h4 mb-0">Library Catalog</h1>
  {% if request.user.is_admin or request.user.is_librarian %}
  <a href="{% url 'catalog:book-create' %}" class="btn btn-primary">Add Book</a>
  {% endif %}
</div>
<form class="row g-2 mb-4" method="get">
  <div class="col-md-4">
    <label class="form-label visually-hidden" for="book-search">Search books</label>
    <input type="search" id="book-search" name="q" value="{{ search_query }}" class="form-control" placeholder="Search by title, author, or ISBN">
  </div>
  <div class="col-md-3">
    {{ filter.form.category.label_tag|default:'' }}
    {{ filter.form.category }}
  </div>
  <div class="col-md-3">
    {{ filter.form.publication_date.label_tag|default:'' }}
    {{ filter.form.publication_date }}
  </div>
  <div class="col-md-2">
    <button type="submit" class="btn btn-outline-secondary w-100">Apply</button>
  </div>
</form>
<div class="row g-4">
  {% for book in object_list %}
  <div class="col-sm-6 col-xl-3">
    <div class="card h-100 card-hover">
      {% if book.cover_image %}
      <img src="{{ book.cover_image.url }}" class="card-img-top" alt="{{ book.title }} cover">
      {% endif %}
      <div class="card-body d-flex flex-column">
        <h5 class="card-title">{{ book.title }}</h5>
        <p class="card-text text-muted">{{ book.author }}</p>
        <p class="mb-2"><span class="badge bg-info text-dark">{{ book.category.name }}</span></p>
        <p class="text-muted small mb-3">Available: {{ book.available_copies }} / {{ book.total_copies }}</p>
        <a href="{% url 'catalog:book-detail' book.pk %}" class="btn btn-outline-primary mt-auto">View Details</a>
      </div>
    </div>
  </div>
  {% empty %}
  <div class="col-12">
    <div class="alert alert-info">No books match your filters.</div>
  </div>
  {% endfor %}
</div>
{% include "includes/pagination.html" with page_obj=page_obj %}
{% endblock %}
